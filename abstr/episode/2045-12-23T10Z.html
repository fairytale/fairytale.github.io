<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Alice M. Lorenz" />
  <title>η Expansion</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../../pandoc/org.css" type="text/css" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<link rel="icon" href="../img/abstr.ico" type="image/vnd.microsoft.icon" />
</head>
<body>
<div id="header">
<h1 class="title">η Expansion</h1>
<h2 class="author">Alice M. Lorenz</h2>
<h3 class="date">2046-01-07T11Z</h3>
</div>
<p align="center" class="file-vars">
(* -*- title: &quot;λ Abstraction&quot;; episode: &quot;η Expansion&quot; -*- *)
</p>
<p align="center">
<a href="../"><img id="logo" src="../img/abstr-logo.png" 
/></a>
</p>
<p align="center" class="warning">
<strong>これは執筆中のページです。</strong>
公開はされているものの、未完成です。
</p>
<p class="local-vars">
(* Local Variables: *)<br />
(* Continued-from: nil *)<br />
(* Continued-on: nil *)<br />
(* Version: &quot;0.0.5a&quot; *)<br />
(* Stability: writing *)<br />
(* Category: Novel *)<br /> 
(* End: *)<br />
</p>
<h1>Abstract</h1>
<p>　冬休みの3日めの夜。しんしんと降り続ける粉雪で、 道路が粉砂糖をかけたココアケーキみたい。 イルミネーションで豪勢に飾られたクリスマスツリーのために 道路は昼間のように明るい。</p>
<p>　仕事で疲れた社会人や 勉強をこなした学生が、みんな、帰りの電車に乗るために 京都駅へ吸い込まれるように集まり、 ちょうどお風呂の栓を抜いたときにできる渦巻きのような 流れをつくっている。</p>
<p>　そんななか、わたしは、京都駅から離れるようにして、 人の流れに逆らうようにして歩いている。</p>
<p>　目的地は京都λ抽象学院だ。</p>
<p>　なぜ、ほかのだれかではなく、よりにもよってこのわたしが 冬休みの3日めに学校へ出向くのかというと、 学校のわたしの住んでいる寮に設置されたサーバに、 昨日の昼頃、何者かが不正にログインし、Facebook Searchという 検索エンジンのTCPパケットを改竄してsearch.facebook.comドメイン以下の すべてのページにマルウェアへのリンクを張ったからだ。</p>
<p>　量子コンピュータでTLSが無力化し、 HTTPSやSSHが無効化されているとはいえ、 そんなに簡単にページの改竄ができるものなのだろうか。</p>
<p>　ともあれ、京都λ抽象学院のルータを通して通信していたたくさんの 〈マシン〉がそのマルウェアに感染したことは事実としてあるらしく、 今日の午後それが発覚して、まず最初に疑われたのが、その 寮に住んでいる、わたしと、ソフィーヤと、真鳥の3人だったわけだ。</p>
<h1>Introduction</h1>
<p>　2045年12月23日土曜日午後7時前。わたしは京都駅からバス停へ向かう。</p>
<p>　バス停でソフィーヤが待っていた。彼女はロシア人だから 寒さには強いと思ってたけど普通に厚着をしていた。</p>
<p>　わたしはカーディガンのポケットに両手を突っ込み、震えながら 彼女を見上げてたずねる。</p>
<p>「ロシア人はこの時期でも薄着かと思ってたけど」</p>
<p>　ソフィーヤは表情を変えず冷静に答える。</p>
<p>「アリス、ロシアはシベリアじゃない……モスクワの気温は……たぶん ザールラントと変わらない」</p>
<p>　アリスことわたしはドイツのザールラント出身。 ソフィーヤはロシアのモスクワ出身。ふたりとも留学生。</p>
<p>　わたしとソフィーヤは京都府に住んでいるから待ち合わせられたけど、 真鳥は兵庫県に住んでいるから時間がかかる。</p>
<p>　それにしても、こんな時間に兵庫県から呼び寄せるなんて、 後藤先生も鬼畜だと思う。</p>
<p>　わたしはぼそっとつぶやく。</p>
<p>「真鳥はたいへんねぇ……ひょっとして今日は帰れないんじゃないかしら」</p>
<p>　ちらっとソフィーヤの顔を見ると、彼女の〈眼鏡〉には メールが表示されていた。彼女はメールを読みながら冷徹にも答える。</p>
<p>「寮があるから平気だと思う」</p>
<p>　バスが来たので、わたしとソフィーヤはバスに乗る。</p>
<p>　ソフィーヤは無言でなにかメールをしているみたい。</p>
<p>　わたしは唇を尖らせてそっぽを向いてたずねる。</p>
<p>「なに読んでるの」</p>
<p>　一緒にいるときにメールを読まれてると、 なんだか無視されてるみたいで。</p>
<p>　ソフィーヤは答える。</p>
<p>「後藤先生に質問してる……というのも……どこまで わかってるのか……掴んでおきたいから」</p>
<p>「サーバに侵入した犯人のこと？」</p>
<p>「そう……」</p>
<p>「ふん。悪いのは学院よ。セキュリティを怠ったのが悪いのよ」</p>
<p>「学院のセキュリティは……かなりしっかりしてると思うけど……」</p>
<p>「思う？　現在形？　わたしたち、意見が合うのね、わたしも 思っていたわよ——過去形であることに注意ね！——侵入された事実はないわ、 フィクションよ！　そうに違いないわ」</p>
<p>「……そうじゃないと思う……問題があったのは学院じゃなくて……むしろ生徒……」</p>
<p>「あらそう。なにか心当たりでも？」</p>
<p>　ソフィーヤは黙って目をうろうろさせ、うつむいてしまう。</p>
<p>　わたしはびっくりして思わずたずねる。</p>
<p>「……ほんとにあるの？」</p>
<p>「わたし……一昨日……サーバにログインしてた……リモートで……SSHで……」</p>
<p>　わたしは耳を疑う。ソフィーヤが？　サーバに？　ログイン？　リモート で？　SSHで？</p>
<p>　……量子コンピュータは市販されている。SSHはほとんど信用ならない、 ログインするならLANでのみ、そう授業で習ったはず。</p>
<p>　SSHは、TLSという——SSLとも呼ばれる——技術に基づいている。</p>
<p>　そしてTLSは、公開鍵暗号——たとえばRSA暗号——に基づいている。</p>
<p>　公開鍵暗号というのは、非対称暗号とも呼ばれていて、 共通鍵暗号——対象暗号——と対をなす暗号システムのこと。</p>
<p>　共通鍵暗号というのは、たいへんわかりやすくて、 2つのノードの間で同じ鍵を用意して、同じアルゴリズムで 暗号化と復号をする方法。</p>
<p>　ところが、共通鍵暗号には、問題がある。 それは、暗号化に使う鍵をどうやって交換するのかということ。 鍵そのものを通信して渡してしまうと、鍵そのものを 盗聴されたら、その鍵を使って暗号化した通信も 復号できてしまうので、意味がない。</p>
<p>　その問題を、きれいとは言えないまでも、 現実的に解決するのが、公開鍵暗号という方法。</p>
<p>　公開鍵と秘密鍵は、ちょっとわかりにくいけど、 “公開鍵で暗号化したものは秘密鍵でしか復号できず、 秘密鍵で暗号化したものは公開鍵でしか復号できない” という性質を持つ鍵のペアのこと。</p>
<p>　公開鍵暗号では、まず、 暗号化したデータを受信するノードが、 公開鍵と秘密鍵のペアを生成する。それから、 暗号化したデータを受信するノードが、 暗号化したデータを送信するノードに、 公開鍵を渡す。</p>
<p>　このとき、公開鍵は盗聴される可能性があるけど、 秘密鍵はどこにも送信していないので盗聴される可能性がないことに注意して。</p>
<p>　ちょっと、この状況を整理すると、</p>
<ol>
<li>暗号化したデータを受信するノードは、秘密鍵を持っていて、</li>
<li>暗号化したデータを送信するノードは、公開鍵を持っていて、</li>
<li>公開鍵は、攻撃者に盗聴されている可能性があり、</li>
<li>秘密鍵は、攻撃者に盗聴されている可能性はない</li>
</ol>
<p>ということになる。</p>
<p>　ここで、暗号化したデータを送信するノードが、 暗号化したデータを受信するノードへ、 公開鍵でデータを暗号化し、送信する。</p>
<p>　公開鍵で暗号化したものは秘密鍵でしか復号できないから、 この暗号化されたデータは、たとえ盗聴できたとしても、 秘密鍵を持っているノードしか復号できない。</p>
<p>　つまり、暗号化したデータを受信するノードしか、 このデータを復号できない。</p>
<p>　こうすることで、</p>
<ol>
<li>通信で公開鍵を送信しつつ、</li>
<li>その公開鍵で暗号化しても安全</li>
</ol>
<p>　という要件を満たせている。</p>
<p>　ただ、公開鍵と秘密鍵のペアがひとつだと、まだ一方通行の 通信しかできない。</p>
<p>　公開鍵は盗聴されている可能性があるから、 秘密鍵で暗号化しても、盗聴された公開鍵で復号される 可能性がある。</p>
<p>　でも、2つのノードがお互いに公開鍵と秘密鍵のペアを生成しあって、 それぞれの公開鍵を交換すれば、問題なく通信できる。</p>
<p>　SSHは、安全にリモート・ログインするためのプロトコルで、 公開鍵暗号で鍵を暗号化して交換し、 その鍵で通信を暗号化することで安全に通信することができた。</p>
<p>　ややこしいけど……つまり、通信自体は共通鍵暗号で暗号化されている んだけど、最初に通信するときの鍵の交換だけは公開鍵暗号で 暗号化しているってわけ。</p>
<p>　どうしてこんなややこしいことをするのかというと。 公開鍵暗号は強力だけど性質上復号に時間がかかるので、 毎回公開鍵暗号で暗号化してたらインタラクティブに処理できない。 そのため、鍵だけを公開鍵暗号で暗号化して送信し、 あとは共通鍵暗号で済ませるってこと。</p>
<p>　RSA暗号は、代表的な公開鍵暗号で、 素数と素数を掛け合わせて合成数を求めるのは簡単だけど、 合成数を素因数分解して素数と素数を求めることは難しいことを 根拠としている。</p>
<p>　たとえば、2048ビット長のRSA暗号を素因数分解で 解読するには、3×10<sup>20</sup>年の時間が必要とも言われていた。</p>
<p>　もっとも、この時間は古典コンピュータの進化とともに短くなっていく んだけど。</p>
<p>　とはいえ、20年から30年前の古典コンピュータの時代では、 RSA暗号はとても頑丈な暗号だった。</p>
<p>　でも、量子コンピュータが登場した。</p>
<p>　量子コンピュータは、ショアのアルゴリズムを使って、 素因数分解を高速に——たとえば2048ビット長のRSA暗号を ものの数秒で——処理できた。</p>
<p>　するとどうなったか。 RSA暗号は安全とは言えなくなって しまった。 なぜなら、もともと RSA 暗号が安全な根拠は、 大きな整数の素因数分解に 3×10<sup>20</sup>年かかるからであって、 暗号化が絶対不可能というわけではなかったのに、 それがものの数秒で解けるようになってしまったから。</p>
<p>　SSH が安全な理由である、鍵の交換を公開鍵でするという 部分が、危険になってしまった。</p>
<p>　長々しくなったけど、要は、 SSH でリモート・ログインすると、 盗聴されて、公開鍵暗号で暗号化したはずの共通鍵暗号の鍵が 解読される危険性がある。そして、その鍵が解読されれば、 通信自体がすべて復号できる。すると、その情報をもとに TCPセッション・ハイジャックが可能となり、その結果、 攻撃者のサーバへのログインを許してしまう。</p>
<p>　とまあ、こういうわけで、SSHでリモート・ログインすることは 校則で禁止されてる。</p>
<p>　でも、リモート・ログインは便利だから、ついつい使ってしまう。 盗聴される危険性があるのもわかるけど、 きっと、わたしだけは大丈夫だろう、そんな気持ちでみんな 使ってしまうんだ。</p>
<p>　わたしは確認する。</p>
<p>「ほんとなの……？」</p>
<p>　ソフィーヤはうなずく。</p>
<p>　鳥肌が立つ。緊張する。</p>
<p>　つまり、その、本当に原因はソフィーヤで、 秘密鍵が解読されて、パスワードが盗まれたってこと？</p>
<p>　もちろん犯人は別にいるとはいえ、そんな事実が発覚したら、 ソフィーヤはどうなるか。退学？　よくて停学？　サーバは 処分されるかも。同じ寮のわたしたちは？　どうなるかわからない。</p>
<p>　これから先の学校生活が破壊される。</p>
<p>　こわい。</p>
<p>　わたしは指をこねくり合わせて目を逸らし、たずねる。</p>
<p>「どっ、どうしてサーバにリモート・ログインしたのかしら」</p>
<p>「それはその……とあるファイルをサーバから〈マシン〉に コピーし忘れてたから……」</p>
<p>　とあるファイルがなんであるかは、たずねないほうがいいだろう。</p>
<p>　わたしはしどろもどろで言う。</p>
<p>「そう、残念、だわ……」</p>
<p>　バスが荒神口通りに着く。</p>
<p>　わたしとソフィーヤはそこで降りて、学校まで歩く。</p>
<p>　夜中の学校の、職員室の窓だけが光っている。</p>
<p>　わたしは門でインターホンを押す。</p>
<p>　インターホンのディスプレイに後藤先生の顔が写り、 彼女はおごそかに言う。</p>
<p>「いま、鍵を開けました。どうぞ入ってください」</p>
<p>　わたしとソフィーヤは学校のなかに入り、 職員室へ向かう。</p>
<p>　職員室の扉を開けると、温暖な空気が漏れ出てきて、 なかに入ると、眼鏡があっという間に曇る。</p>
<p>　わたしとソフィーヤは眼鏡を一度外し、結露を拭いてから 再度身に付ける。</p>
<p>　職員室には後藤先生——わたしたちの担任——以外の先生はいない。</p>
<p>　わたしたちは後藤先生の机まで行く。</p>
<p>　後藤先生はしかめっ面で椅子に座っている。</p>
<p>　後藤先生がふだん通りの優しい口調で言う。</p>
<p>「どうぞ、空いている席はたくさんあります。お座りください」</p>
<p>　ソフィーヤは黙って言うとおりに座る。</p>
<p>　わたしはある椅子に座る前に高さを調節してから——つまり、 悔しいけど座席部分を可能な限り高くしてから——その椅子に座る。 それでもやや低過ぎる気がして悔しい。</p>
<p>　ソフィーヤがわたしを気遣ってくれたのか、何気なく言う。</p>
<p>「なんなら……わたしの膝の上に座っても……」</p>
<p>　わたしは顔が真っ赤になる気がした。 そういうことはその、ふたりきりのときなら嬉しいけど、 いまは後藤先生の前だし……。わたしはそっぽを向いて抗議する。</p>
<p>　後藤先生の〈眼鏡〉にウィンドウが表示されている。 どうやらメールしているみたいだ。</p>
<p>　後藤先生は指でたんと机を叩くような仕草をする。 〈指輪〉——ブレイン・マシン・インターフェイスの一種で、 指の神経への電気信号を理解し、空中でも机でもどこでも、 タップすることでクリックやダブルクリックができて、 指で空をなぞることでマウスポインタを動かせる、 マウスに代わる入力デバイス——を操作しているのだ。 その操作で、彼女は眼鏡に表示されたウィンドウを閉じ、 言う。</p>
<p>「真鳥さんはあと17分ほどで到着するようです。 真鳥さんが来てからまた話すことになるのは時間のムダですし、 詳しい話は彼女が到着してからにしましょう」</p>
<p>　ソフィーヤが即座に答える。</p>
<p>「賛成……です……」</p>
<p>　わたしは質問する。</p>
<p>「それまではどうします？」</p>
<h1>Methods</h1>
<h1>Results</h1>
<h1>Discussion</h1>
<h1>Conclusion</h1>
<p class="local-vars">
(* Local Variables: *)<br />
(* Continued-from: nil *)<br />
(* Continued-on: nil *)<br />
(* Revision: &quot;44cc93e4b12121be29c1cab2e24fd4b05ec69414&quot; *)<br />
(* End: *)<br />
</p>
</body>
</html>
